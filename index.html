<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>GrepoBot Pro - Automatizaci√≥n de √âlite</title>
    <!-- PayPal SDK: TU client-id SANDBOX -->
    <script src="https://www.paypal.com/sdk/js?client-id=ELfatqhPTNKEgwZ1gIaTJZ97kp-CaK_ipoT_L9C_mDJiuUyTgTv_HLLHeXNPHrlwRQbmcPmYWIGsBSlZ&currency=USD"></script>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #191919; color: #e0e0e0; margin:0;}
        .logo { font-size: 32px; color: #4caf50; margin-top: 22px; font-weight: bold;}
        nav { background: #232323; padding:17px; text-align:right;}
        nav a, nav button {color: #4caf50; background: none; border:none; padding:11px 18px; font-size:16px; cursor:pointer;}
        .hero { text-align: center; margin-top: 44px;}
        .cta-button { background: #4caf50; color: #fff; padding: 13px 30px; border: none; border-radius: 5px; font-size: 20px; cursor:pointer; font-weight:bold;}
        section.guide-section, section.gallery-section { max-width:860px; margin:35px auto 0 auto; padding:22px; background:#232323; border-radius:12px;}
        .gallery-section {display:flex; gap:28px; justify-content:center;}
        .gallery-item img { width:280px; border-radius:8px; border:2px solid #333;}
        .gallery-item p { text-align:center;}
        .login-box { max-width:440px; margin:38px auto; background:#232323; padding:32px; border-radius:10px;}
        .input-group {margin-bottom:17px;}
        .input-group label {display:block;margin-bottom:5px;}
        .input-group input { width:100%; background:#222; border:1px solid #444; color:#fff; border-radius:4px; padding:7px;}
        .alert { padding:10px; border-radius:5px; margin-bottom:15px;font-size:15px;display:none;}
        .alert.error { background: #ffdddd; color: #d00;}
        .alert.success { background: #dfffe3; color: #18831b;}
        .premium-box { background: #202020; padding:19px; border-radius:8px; margin-top:20px;}
        .plans-container { display: flex; gap:13px; justify-content:center;}
        .plan-card { background:#2c2c26; border-radius:8px; border:2px solid #444; padding:12px; margin-bottom:5px; min-width:130px; cursor:pointer;}
        .plan-card.selected { border-color: #ffd700; background:#23231a;}
        .plan-price { color:#ffd700;}
        .plan-save { color:#4caf50; font-size:12px;}
        .chat-widget { position: fixed; bottom: 20px; right: 20px; z-index: 9999;}
        .chat-btn { background: #4caf50; width: 55px; height: 55px; border-radius: 50%; border: none; cursor: pointer; font-size: 30px; color: white;}
        .chat-window { display:none; position:absolute;bottom:65px;right:0;width:340px;height:440px;background:#232326;border:1px solid #333;border-radius:10px; box-shadow:0 8px 35px #000;}
        .chat-header { background: #252525; padding:12px; border-bottom:1px solid #333;display:flex;justify-content:space-between;align-items:center;}
        .chat-header h3 {margin:0;}
        .chat-input-area {padding:8px;background:#252525; display:flex;gap:6px;}
        .chat-input-area input { flex: 1; border-radius:18px; border:1px solid #555; padding:7px;}
        .chat-input-area button { background:#4caf50; border:none; color:white; font-size:17px; border-radius:15px; padding:0 16px;}
        .chat-body {flex:1;padding:12px;overflow-y:auto;display:flex;flex-direction:column;gap:7px;}
        .msg {padding:7px 14px; border-radius:14px; max-width:80%; font-size:14px;}
        .msg.bot {background:#444; align-self:flex-start;}
        .msg.user {background:#4caf50; color:white; align-self:flex-end;}
        footer { text-align:center;padding:24px;color:#aaa;font-size:14px;}
        @media(max-width:530px) {.gallery-section{flex-direction:column;}}
    </style>
</head>
<body>
<div class="logo">‚öîÔ∏è GrepoBot Pro</div>
<nav>
    <a href="#guide">Manual</a>
    <a href="#gallery">Galer√≠a</a>
    <a href="#portal">Portal</a>
</nav>
<section class="hero">
    <h1>Domina el Mundo, <span style="color:#4caf50;">Autom√°ticamente</span></h1>
    <p>El bot m√°s avanzado para Grepolis. Indetectable y con Soporte IA incluido.</p>
    <button class="cta-button" onclick="document.getElementById('portal').scrollIntoView({behavior:'smooth'})">PRUEBA DE 7 D√çAS</button>
</section>
<section id="guide" class="guide-section">
    <h2>Manual de Inicio R√°pido</h2>
    <ul>
        <li>Instala <b>Tampermonkey</b> en tu navegador</li>
        <li>Reg√≠strate abajo y paga o usa el trial gratuito</li>
        <li>Pulsa ‚ÄúINSTALAR BOT‚Äù en el portal</li>
    </ul>
    <ul>
        <li>Para atacar: abre la ventana de ataque, pon la hora y pulsa ‚ÄúCapturar‚Äù e ‚ÄúIniciar‚Äù</li>
        <li>Renueva licencia abajo, pago autom√°tico con PayPal</li>
    </ul>
</section>
<section id="gallery" class="gallery-section">
    <div class="gallery-item">
        <img src="bot1.jpg" alt="bot planner">
        <p>Planner Preciso</p>
    </div>
    <div class="gallery-item">
        <img src="bot2.jpg" alt="menu bot">
        <p>Men√∫ Completo</p>
    </div>
</section>
<section id="portal">
    <div class="login-box">
        <h2 style="text-align:center; margin-bottom:18px;">Acceso al Portal</h2>
        <div id="login-form">
            <div class="input-group"><label>Usuario</label><input type="text" id="user" placeholder="Usuario"></div>
            <div class="input-group"><label>Contrase√±a</label><input type="password" id="pass" placeholder="Contrase√±a"></div>
            <button class="cta-button" style="width:100%;" onclick="acceder()">Entrar / Registrar</button>
            <div id="msg-login" class="alert"></div>
        </div>
        <div id="dashboard" style="display:none;">
            <h3 id="user-display" style="color:#4caf50;"></h3>
            <div id="status-licencia" class="alert success" style="margin-bottom:20px;">Cargando...</div>
            <div style="background:#23231a; padding:11px; border-radius:8px; margin-bottom:20px;">
                <h4>Instalaci√≥n</h4>
                <p>Instala el script en Tampermonkey haciendo click en el bot√≥n</p>
                <button class="cta-button" style="width:100%;" id="btn-descargar" onclick="descargarArchivo()">üì• INSTALAR BOT</button>
                <div id="msg-descarga" style="margin-top:8px;font-size:13px;"></div>
            </div>
            <div class="premium-box">
                <h3 style="text-align:center; color:#ffd700;">üíé Renovar Licencia</h3>
                <p style="text-align:center; color:#aaa; margin-bottom:14px;">Elige tu plan:</p>
                <div class="plans-container">
                    <div class="plan-card selected" onclick="selectPlan('1_MES', this)">
                        <span class="plan-name">1 Mes</span>
                        <span class="plan-price">$7.99</span>
                    </div>
                    <div class="plan-card" onclick="selectPlan('6_MESES', this)">
                        <span class="plan-name">6 Meses</span>
                        <span class="plan-price">$45.00</span>
                        <span class="plan-save">Ahorra 10%</span>
                    </div>
                    <div class="plan-card" onclick="selectPlan('12_MESES', this)">
                        <span class="plan-name">1 A√±o</span>
                        <span class="plan-price">$80.00</span>
                        <span class="plan-save">Ahorra 20%</span>
                    </div>
                </div>
                <div id="paypal-button-container"></div>
            </div>
        </div>
    </div>
</section>
<div class="chat-widget">
    <button class="chat-btn" onclick="toggleChat()">ü§ñ</button>
    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <h3>Soporte IA GrepoBot</h3>
            <span style="cursor:pointer;" onclick="toggleChat()">‚úñ</span>
        </div>
        <div class="chat-body" id="chatBody">
            <div class="msg bot">Hola üëã Soy la IA de soporte. ¬øEn qu√© puedo ayudarte?<br><br>Ejemplos:<br>- "No me funciona"<br>- "¬øC√≥mo pagar?"<br>- "Instalar"</div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="Escribe tu duda..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">‚û§</button>
        </div>
    </div>
</div>
<footer>
    ¬© 2026 GrepoBot Team. Software educativo.
</footer>
<script>
    // === CONFIGURACI√ìN GENERAL RENDER ===
    const API = 'https://grepobot-web.onrender.com/api';
    let currentUserId = null;
    let selectedPlanId = '1_MES';

    function selectPlan(planId, element){
        selectedPlanId = planId;
        document.querySelectorAll('.plan-card').forEach(el=>el.classList.remove('selected'));
        element.classList.add('selected');
        document.getElementById('paypal-button-container').innerHTML = '';
        renderPayPalButtons();
    }
    async function acceder() {
        const u = document.getElementById('user').value;
        const p = document.getElementById('pass').value;
        const msg = document.getElementById('msg-login');
        msg.style.display = "none";
        if(!u || !p){msg.textContent="‚ö†Ô∏è Faltan datos"; msg.className="alert error";msg.style.display='block';return;}
        fetch(API+'/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})})
        .then(res=>res.json()).then(data=>{
            if(!data.success){
                fetch(API+'/registro',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})})
                .then(res=>res.json()).then(data2=>{
                    procesarLogin(data2,u,msg);
                });
            }else{
                procesarLogin(data,u,msg);
            }
        });
    }
    function procesarLogin(data,u,msg){
        if(data.success){
            currentUserId = data.usuarioId;
            document.getElementById('login-form').style.display='none';
            document.getElementById('dashboard').style.display='block';
            document.getElementById('user-display').textContent = "Hola, " + (data.username || u);
            if(data.dias<=0){
                statusLic("‚õî LICENCIA CADUCADA<br>Renueva abajo para continuar.","error");
            }else{
                statusLic("‚úÖ Licencia activa: "+data.dias+" d√≠as","success");
            }
            const btnDescargar = document.getElementById('btn-descargar');
            if(data.yaDescargo){
                btnDescargar.disabled=true;
                btnDescargar.style.opacity="0.5";
                btnDescargar.style.cursor="not-allowed";
                document.getElementById('msg-descarga').innerHTML ='‚ùå Ya descargaste el bot. Renueva para descargar de nuevo';
            }else{
                btnDescargar.disabled = false;
                btnDescargar.style.opacity = "";
                btnDescargar.style.cursor="";
                document.getElementById('msg-descarga').innerHTML = '‚úÖ Descarga disponible (una sola vez)';
            }
            renderPayPalButtons();
        }else{
            msg.textContent = data.error || "Error"; msg.className="alert error";msg.style.display='block';
        }
    }
    function statusLic(txt,type){
        const node = document.getElementById('status-licencia');
        node.textContent = ""; node.className="alert "+type; node.innerHTML = txt; node.style.display = "block";
    }
    function descargarArchivo(){
        if(!currentUserId)return alert("Sesi√≥n expirada");
        window.open(API + '/descargar/' + currentUserId + '/GrepoBot.user.js', "_blank");
    }
    function renderPayPalButtons(){
        document.getElementById('paypal-button-container').innerHTML='';
        paypal.Buttons({
            createOrder: function(data, actions){
                return fetch(API + '/paypal/create-order',{
                    method: 'post',
                    headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({ planId: selectedPlanId })
                }).then(res=>res.json()).then(orderData=>orderData.id);
            },
            onApprove: function(data, actions){
                return fetch(API + '/paypal/capture-order',{
                    method: 'post',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ orderID: data.orderID, usuarioId: currentUserId, planId: selectedPlanId })
                }).then(res=>res.json()).then(details=>{
                    alert('‚úÖ ¬°PAGO COMPLETADO! Licencia renovada.');
                    location.reload();
                });
            }
        }).render('#paypal-button-container');
    }
    // Chat IA
    function toggleChat() {
        let win = document.getElementById('chatWindow');
        win.style.display=(win.style.display==='flex')?'none':'flex';
        win.style.flexDirection="column";
    }
    function sendMessage() {
        const input = document.getElementById('chatInput');
        const text = input.value.trim();
        if(!text)return;
        addMessage(text,'user'); input.value='';
        setTimeout(()=>addMessage(obtenerRespuestaIA(text.toLowerCase()),'bot'),500);
    }
    function addMessage(text,type){
        const body = document.getElementById('chatBody'),div=document.createElement('div');
        div.className='msg '+type;div.innerHTML=text;body.appendChild(div);body.scrollTop=body.scrollHeight;
    }
    function obtenerRespuestaIA(txt){
        if(txt.includes('hola')) return "¬°Hola! Soy la IA de GrepoBot. ¬øEn qu√© te ayudo?";
        if(txt.includes('pagar')||txt.includes('paypal')) return "Para pagar, inicia sesi√≥n y selecciona uno de los planes. El pago es autom√°tico.";
        if(txt.includes('instalar')) return "1. Instala Tampermonkey.<br>2. Inicia sesi√≥n.<br>3. Pulsa 'INSTALAR BOT'.";
        if(txt.includes('no funciona')) return "Comprueba que tu licencia est√° activa y recarga la web.";
        if(txt.includes('precio')) return "Planes:<br>- 1 Mes: $7.99<br>- 6 Meses: $45<br>- 1 A√±o: $80";
        return "No te entiendo bien. Prueba con 'pagar', 'instalar' o 'precios'.";
    }
</script>
</body>
</html>