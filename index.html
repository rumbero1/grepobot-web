<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrepoBot Pro - Automatizaci√≥n de √âlite</title>
    <script src="https://www.paypal.com/sdk/js?client-id=ARI8xtvx-zlykSa7RFIka_g5C3_iF8-CaK_ipoT_L9C_mDJiuUyTgTv_HLLHeXNPHrlwRQbmcPmYWIGs&currency=USD"></script>
    <style>
    :root { --primary: #4caf50; --dark: #121212; --dark-card: #1e1e1e; --text: #e0e0e0; --text-muted: #a0a0a0; --gold: #ffd700;}
    body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background: var(--dark); color: var(--text); margin: 0; line-height: 1.6;}
    nav { display: flex; justify-content: space-between; align-items: center; padding: 20px 50px; background: rgba(0,0,0,0.9); position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #333;}
    .logo { font-size: 24px; font-weight: bold; color: var(--primary);}
    .nav-links a { color: var(--text); text-decoration: none; margin-left: 20px; font-size: 14px;}
    .btn-login { background: transparent; border: 1px solid var(--primary); color: var(--primary); padding: 8px 20px; border-radius: 4px; cursor: pointer;}
    .btn-login:hover { background: var(--primary); color: white;}
    .hero { text-align: center; padding: 90px 20px 30px; background: radial-gradient(circle at center, #222 0%, #111 100%);}
    .hero h1 { font-size: 44px; margin-bottom: 10px; color: white;}
    .hero span { color: var(--primary);}
    .hero p { font-size: 18px; color: var(--text-muted);}
    .cta-button { background: var(--primary); color: white; padding: 12px 32px; border: none; border-radius: 5px; font-size: 18px; font-weight: bold; cursor: pointer;}
    .cta-button:hover { transform: translateY(-2px);}
    .guide-section { background: #181818; padding: 40px 0;}
    .guide-container { max-width: 850px; margin: 0 auto;}
    .guide-item { margin-bottom: 20px; background: #252525; padding: 16px; border-radius: 8px; border-left: 4px solid var(--primary);}
    .guide-item h3 { margin-top: 0;}
    .gallery-section { background: #151515; padding: 40px 0;}
    .gallery-grid { display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;}
    .gallery-item { text-align: center;}
    .gallery-item img { width: 290px; height: 170px; object-fit: cover; border-radius: 8px; border: 2px solid #333;}
    .gallery-item img:hover { border-color: var(--primary);}
    #portal { padding: 30px 10px; max-width: 600px; margin: 0 auto;}
    .login-box { background: var(--dark-card); padding: 30px; border-radius: 12px; border: 1px solid #444;}
    .input-group { margin-bottom: 20px;}
    .input-group label { display: block; margin-bottom: 6px;}
    .input-group input { width: 100%; padding: 10px; background: #272727; border: 1px solid #444; color: white; border-radius: 4px;}
    .alert { padding: 15px; border-radius: 4px; margin-top: 18px; font-size: 14px; display: none; text-align: center;}
    .alert.error { background: rgba(255, 82, 82, 0.1); color: #ff5252; border: 1px solid #ff5252;}
    .alert.success { background: rgba(76, 175, 80, 0.1); color: #4caf50; border: 1px solid #4caf50;}
    #dashboard { display: none;}
    .premium-box { background: #181818; padding: 18px; border-radius: 8px; margin-top: 26px;}
    .plans-container { display: flex; justify-content: center; gap: 18px;}
    .plan-card { background: #252525; border: 2px solid #444; border-radius: 8px; padding: 13px; width: 27%; min-width: 120px; cursor: pointer;}
    .plan-card.selected { border-color: var(--gold); background: #23231a;}
    .plan-name, .plan-price { display: block;}
    .plan-price { color: var(--gold);}
    .plan-save { font-size: 11px; color: #4caf50;}
    .chat-widget { position: fixed; bottom: 17px; right: 17px; z-index: 9999;}
    .chat-btn { background: var(--primary); width: 60px; height: 60px; border-radius: 50%; border: none; cursor: pointer; font-size: 30px; color: white;}
    .chat-window { display: none; position: absolute; bottom: 70px; right: 0; width: 340px; height: 470px; background: #232326; border: 1px solid #333; border-radius: 10px; box-shadow: 0 10px 35px rgba(0,0,0,0.85);}
    .chat-header { background: #252525; padding: 15px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center;}
    .chat-header h3 { margin: 0; font-size: 16px; color: white;}
    .chat-body { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;}
    .chat-input-area { padding: 12px; background: #252525; display: flex; gap: 9px;}
    .chat-input-area input { flex: 1; border-radius: 20px; border: 1px solid #444; padding: 10px;}
    .chat-input-area button { background: var(--primary); border: none; color: white; padding: 0 13px; border-radius: 20px;}
    .msg { padding: 10px 15px; border-radius: 14px; max-width: 80%; font-size: 13px;}
    .msg.bot { background: #333; align-self: flex-start; color: #ddd;}
    .msg.user { background: var(--primary); align-self: flex-end; color: #fff;}
    footer { text-align: center; padding: 32px; color: var(--text-muted); font-size: 12px; border-top: 1px solid #222;}
    </style>
</head>
<body>
<nav>
    <div class="logo">‚öîÔ∏è GrepoBot Pro</div>
    <div class="nav-links">
        <a href="#guide">Manual</a>
        <a href="#gallery">Galer√≠a</a>
        <a href="#portal">Precios</a>
        <button class="btn-login" onclick="scrollToPortal()">Area Clientes</button>
    </div>
</nav>
<section class="hero">
    <h1>Domina el Mundo, <span>Autom√°ticamente</span></h1>
    <p>El bot m√°s avanzado para Grepolis. Indetectable y con Soporte IA incluido.</p>
    <button class="cta-button" onclick="scrollToPortal()">PRUEBA DE 7 D√çAS</button>
</section>
<section id="guide" class="guide-section">
    <div class="guide-container">
        <h2 class="section-title">Manual de Inicio R√°pido</h2>
        <div class="guide-item"><h3>1. Instalaci√≥n</h3><p>1. Instala <b>Tampermonkey</b> en tu navegador.<br>2. Reg√≠strate y paga o usa el trial.<br>3. Pulsa ‚ÄúInstalar Bot‚Äù.</p></div>
        <div class="guide-item"><h3>2. Atacar</h3><p>1. Abre la ventana de ataque.<br>2. Pon la hora en el bot.<br>3. Pulsa Capturar y luego Iniciar.</p></div>
        <div class="guide-item"><h3>3. Pago/Renovaci√≥n</h3><p>Selecciona el plan, paga por Paypal y la activaci√≥n es instant√°nea.</p></div>
    </div>
</section>
<section id="gallery" class="gallery-section">
    <h2>Interfaz del Bot</h2>
    <div class="gallery-grid">
        <div class="gallery-item">
            <img src="bot1.jpg" alt="Planner">
            <p>Planner de Precisi√≥n</p>
        </div>
        <div class="gallery-item">
            <img src="bot2.jpg" alt="Men√∫">
            <p>Men√∫ Completo</p>
        </div>
    </div>
</section>
<section id="portal">
    <div class="login-box">
        <h2 style="text-align:center; margin-bottom:20px;">Acceso al Portal</h2>
        <div id="login-form">
            <div class="input-group"><label>Usuario</label>
                <input type="text" id="user" placeholder="Tu nombre de usuario"></div>
            <div class="input-group"><label>Contrase√±a</label>
                <input type="password" id="pass" placeholder="Tu contrase√±a"></div>
            <button class="cta-button" style="width:100%; font-size:16px;" onclick="acceder()">ENTRAR / REGISTRARSE</button>
            <div id="msg-login" class="alert"></div>
        </div>
        <div id="dashboard">
            <h3 style="text-align:center; color:#4caf50;">Hola, <span id="user-display"></span></h3>
            <div id="status-licencia" class="alert success" style="display:block; margin-bottom:17px;">Cargando...</div>
            <div style="background:#222; padding:12px; border-radius:5px; margin-bottom:17px;">
                <h4>1. Instalaci√≥n</h4>
                <p style="font-size:12px; color:#aaa;">Instalar script en Tampermonkey</p>
                <button class="cta-button" id="btn-descargar" style="width:100%;" onclick="descargarArchivo()">üì• INSTALAR BOT</button>
                <div id="msg-descarga" style="margin-top:9px; font-size:12px;"></div>
            </div>
            <div class="premium-box">
                <h3 style="text-align:center; color:var(--gold);">üíé Renovar Licencia</h3>
                <p style="text-align:center; color:#aaa; margin-bottom:14px;">Elige tu plan:</p>
                <div class="plans-container">
                    <div class="plan-card selected" onclick="selectPlan('1_MES', this)">
                        <span class="plan-name">1 Mes</span>
                        <span class="plan-price">$7.99</span>
                    </div>
                    <div class="plan-card" onclick="selectPlan('6_MESES', this)">
                        <span class="plan-name">6 Meses</span>
                        <span class="plan-price">$45.00</span>
                        <span class="plan-save">Ahorra 10%</span>
                    </div>
                    <div class="plan-card" onclick="selectPlan('12_MESES', this)">
                        <span class="plan-name">1 A√±o</span>
                        <span class="plan-price">$80.00</span>
                        <span class="plan-save">Ahorra 20%</span>
                    </div>
                </div>
                <div id="paypal-button-container"></div>
            </div>
        </div>
    </div>
</section>
<div class="chat-widget">
    <button class="chat-btn" onclick="toggleChat()">ü§ñ</button>
    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <h3>Soporte IA GrepoBot</h3>
            <span style="cursor:pointer;" onclick="toggleChat()">‚úñ</span>
        </div>
        <div class="chat-body" id="chatBody">
            <div class="msg bot">Hola üëã Soy la IA de soporte.<br><br>Ejemplos:<br>- "No me funciona"<br>- "¬øC√≥mo pagar?"<br>- "Instalar"</div>
        </div>
        <div class="chat-input-area">
            <input type="text" id="chatInput" placeholder="Escribe tu duda..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button onclick="sendMessage()">‚û§</button>
        </div>
    </div>
</div>
<footer>
    <p>¬© 2026 GrepoBot Team. Software educativo.</p>
</footer>
<script>
    // --- CONFIGURACI√ìN API ---
    const API = 'https://grepobot-web.onrender.com/api';

    let currentUserId = null;
    let selectedPlanId = '1_MES';

    function scrollToPortal() { document.getElementById('portal').scrollIntoView({behavior: 'smooth'}); }
    function selectPlan(planId, element) {
        selectedPlanId = planId;
        document.querySelectorAll('.plan-card').forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
        document.getElementById('paypal-button-container').innerHTML = '';
        renderPayPalButtons();
    }
    async function acceder() {
        const u = document.getElementById('user').value;
        const p = document.getElementById('pass').value;
        const msg = document.getElementById('msg-login');
        if(!u || !p) { msg.textContent="Faltan datos"; msg.className = "alert error"; msg.style.display='block'; return; }
        let res = await fetch(API + '/login', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username:u, password:p}) });
        let data = await res.json();
        if(!data.success) {
            if(confirm("Usuario no encontrado. ¬øRegistrar nueva cuenta?")) {
                res = await fetch(API + '/registro', { method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username:u, password:p}) });
                data = await res.json();
            } else return;
        }
        if(data.success) {
            currentUserId = data.usuarioId;
            document.getElementById('login-form').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('user-display').textContent = data.username || u;
            const statusDiv = document.getElementById('status-licencia');
            if(data.dias <= 0) {
                statusDiv.className = "alert error";
                statusDiv.innerHTML = `‚õî <b>LICENCIA CADUCADA</b><br>Renueva abajo para continuar.`;
            } else {
                statusDiv.className = "alert success";
                statusDiv.innerHTML = `‚úÖ <b>Licencia Activa</b> (${data.dias} d√≠as restantes)`;
            }
            const btnDescargar = document.getElementById('btn-descargar');
            if (data.yaDescargo) {
                btnDescargar.disabled = true;
                btnDescargar.style.opacity = '0.5';
                btnDescargar.style.cursor = 'not-allowed';
                document.getElementById('msg-descarga').innerHTML = '<span style="color:#ff5252;">‚ùå Ya descargaste el bot. No puedes descargar de nuevo hasta renovar la licencia.</span>';
            } else {
                document.getElementById('msg-descarga').innerHTML = '<span style="color:#4caf50;">‚úÖ Descarga disponible (una sola vez)</span>';
            }
            renderPayPalButtons();
        } else {
            msg.textContent = data.error || "Error en el login";
            msg.className = "alert error";
            msg.style.display = 'block';
        }
    }
    function descargarArchivo() {
        if(!currentUserId) return alert("Sesi√≥n expirada");
        const scriptUrl = API + '/descargar/' + currentUserId + '/GrepoBot.user.js';
        window.open(scriptUrl, "_blank");
    }
    function renderPayPalButtons() {
        document.getElementById('paypal-button-container').innerHTML = '';
        paypal.Buttons({
            createOrder: function(data, actions) {
                return fetch(API + '/paypal/create-order', {
                    method: 'post',
                    headers: {'Content-Type':'application/json'},
                    body: JSON.stringify({ planId: selectedPlanId })
                }).then(res => res.json()).then(orderData => orderData.id);
            },
            onApprove: function(data, actions) {
                return fetch(API + '/paypal/capture-order', {
                    method: 'post',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ orderID: data.orderID, usuarioId: currentUserId, planId: selectedPlanId })
                }).then(res => res.json()).then(details => {
                    alert('‚úÖ ¬°PAGO COMPLETADO! Licencia renovada.');
                    location.reload();
                });
            }
        }).render('#paypal-button-container');
    }
    // --- CHATBOT LOGIC ---
    function toggleChat() {
        const win = document.getElementById('chatWindow');
        win.style.display = (win.style.display === 'flex') ? 'none' : 'flex';
        win.style.flexDirection = "column";
    }
    function sendMessage() {
        const input = document.getElementById('chatInput');
        const text = input.value.trim();
        if(!text) return;
        addMessage(text, 'user');
        input.value = '';
        setTimeout(() => {
            const respuesta = obtenerRespuestaIA(text.toLowerCase());
            addMessage(respuesta, 'bot');
        }, 500);
    }
    function addMessage(text, type) {
        const body = document.getElementById('chatBody');
        const div = document.createElement('div');
        div.className = `msg ${type}`;
        div.innerHTML = text;
        body.appendChild(div);
        body.scrollTop = body.scrollHeight;
    }
    function obtenerRespuestaIA(txt) {
        if(txt.includes('hola')) return "¬°Hola! Soy la IA de GrepoBot. ¬øEn qu√© te ayudo?";
        if(txt.includes('pagar') || txt.includes('paypal')) return "Para pagar, inicia sesi√≥n y selecciona uno de los planes (1 Mes, 6 Meses o 1 A√±o). El pago es autom√°tico.";
        if(txt.includes('instalar')) return "1. Instala Tampermonkey.<br>2. Inicia sesi√≥n.<br>3. Pulsa 'INSTALAR BOT'.<br>4. Acepta en Tampermonkey.";
        if(txt.includes('no funciona')) return "Revisa si tu licencia ha caducado. Si has pagado y no va, recarga la p√°gina.";
        if(txt.includes('precio')) return "Tenemos 3 planes:<br>- 1 Mes: $7.99<br>- 6 Meses: $45<br>- 1 A√±o: $80";
        return "No te entiendo bien. Prueba con 'pagar', 'instalar' o 'precios'.";
    }
</script>
